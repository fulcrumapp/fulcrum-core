{"version":3,"sources":["../../src/elements/classification-element.js"],"names":["ClassificationElement","parent","attributes","allowOther","allow_other","_classificationFilter","_overrideClassificationItems","_classificationSetID","classification_set_id","load","dataSource","callback","getClassificationSet","err","classificationSet","resetOverrides","filteredClassifications","classificationFilter","overrideClassificationSetItems","length","classificationItems","classificationAttributes","classification","Classification","push","Object","assign","getOwnPropertyDescriptor","Element","prototype","get","call","overrideClassificationItems","items","filteredItems","item","filter","toLowerCase","value"],"mappings":"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","sourcesContent":["import Element from './element';\nimport Classification from './classification';\n\nexport default class ClassificationElement extends Element {\n  constructor(parent, attributes) {\n    super(parent, attributes);\n\n    this.allowOther = !!attributes.allow_other;\n\n    this._classificationFilter = null;\n\n    this._overrideClassificationItems = null;\n\n    this._classificationSetID = attributes.classification_set_id;\n  }\n\n  load(dataSource, callback) {\n    dataSource.getClassificationSet(this._classificationSetID, (err, classificationSet) => {\n      // TODO(zhm) Some forms have orphaned classification sets (life sucks)\n      // Maybe we should add a parameter to the load() method to throw\n      // errors.\n      if (err) {\n        return callback(err);\n      }\n\n      this.classificationSet = classificationSet;\n\n      return callback();\n    });\n  }\n\n  get classificationItems() {\n    return this._overrideClassificationItems ? this._overrideClassificationItems : this.filteredClassifications;\n  }\n\n  get classificationFilter() {\n    return this._classificationFilter;\n  }\n\n  set classificationFilter(classificationFilter) {\n    this._classificationFilter = classificationFilter;\n  }\n\n  set overrideClassificationItems(overrideClassificationSetItems) {\n    if (!overrideClassificationSetItems || overrideClassificationSetItems.length < 1) {\n      this._overrideClassificationItems = null;\n      return;\n    }\n\n    const classificationItems = [];\n\n    for (const classificationAttributes of overrideClassificationSetItems) {\n      const classification = new Classification(null, classificationAttributes);\n\n      classificationItems.push(classification);\n    }\n\n    this._overrideClassificationItems = classificationItems;\n  }\n\n  get overrideValues() {\n    return Object.assign(Object.getOwnPropertyDescriptor(Element.prototype, 'overrideValues').get.call(this), {\n      classificationFilter: this._classificationFilter,\n      overrideClassificationItems: this._overrideClassificationItems\n    });\n  }\n\n  resetOverrides() {\n    super.resetOverrides();\n\n    this._classificationFilter = null;\n    this._overrideClassificationItems = null;\n  }\n\n  get filteredClassifications() {\n    if (!this.classificationSet) {\n      return [];\n    }\n\n    const items = this.classificationSet.items;\n\n    if (!this.classificationFilter) {\n      return items;\n    }\n\n    const filteredItems = [];\n\n    if (items) {\n      for (const item of items) {\n        for (const filter of this.classificationFilter) {\n          if (filter.toLowerCase() === item.value.toLowerCase()) {\n            filteredItems.push(item);\n          }\n        }\n      }\n    }\n\n    return filteredItems;\n  }\n}\n"],"file":"classification-element.js"}