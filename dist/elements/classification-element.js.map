{"version":3,"file":"classification-element.js","names":["ClassificationElement","parent","attributes","allowOther","allow_other","_classificationFilter","_overrideClassificationItems","_classificationSetID","classification_set_id","load","dataSource","callback","getClassificationSet","err","classificationSet","resetOverrides","filteredClassifications","classificationFilter","overrideClassificationSetItems","length","classificationItems","classificationAttributes","classification","Classification","push","Object","assign","getOwnPropertyDescriptor","Element","prototype","get","call","overrideClassificationItems","items","filteredItems","item","filter","toLowerCase","value"],"sources":["../../src/elements/classification-element.js"],"sourcesContent":["import Element from './element';\nimport Classification from './classification';\n\nexport default class ClassificationElement extends Element {\n  constructor(parent, attributes) {\n    super(parent, attributes);\n\n    this.allowOther = !!attributes.allow_other;\n\n    this._classificationFilter = null;\n\n    this._overrideClassificationItems = null;\n\n    this._classificationSetID = attributes.classification_set_id;\n  }\n\n  load(dataSource, callback) {\n    dataSource.getClassificationSet(this._classificationSetID, (err, classificationSet) => {\n      // TODO(zhm) Some forms have orphaned classification sets (life sucks)\n      // Maybe we should add a parameter to the load() method to throw\n      // errors.\n      if (err) {\n        return callback(err);\n      }\n\n      this.classificationSet = classificationSet;\n\n      return callback();\n    });\n  }\n\n  get classificationItems() {\n    return this._overrideClassificationItems ? this._overrideClassificationItems : this.filteredClassifications;\n  }\n\n  get classificationFilter() {\n    return this._classificationFilter;\n  }\n\n  set classificationFilter(classificationFilter) {\n    this._classificationFilter = classificationFilter;\n  }\n\n  set overrideClassificationItems(overrideClassificationSetItems) {\n    if (!overrideClassificationSetItems || overrideClassificationSetItems.length < 1) {\n      this._overrideClassificationItems = null;\n      return;\n    }\n\n    const classificationItems = [];\n\n    for (const classificationAttributes of overrideClassificationSetItems) {\n      const classification = new Classification(null, classificationAttributes);\n\n      classificationItems.push(classification);\n    }\n\n    this._overrideClassificationItems = classificationItems;\n  }\n\n  get overrideValues() {\n    return Object.assign(Object.getOwnPropertyDescriptor(Element.prototype, 'overrideValues').get.call(this), {\n      classificationFilter: this._classificationFilter,\n      overrideClassificationItems: this._overrideClassificationItems\n    });\n  }\n\n  resetOverrides() {\n    super.resetOverrides();\n\n    this._classificationFilter = null;\n    this._overrideClassificationItems = null;\n  }\n\n  get filteredClassifications() {\n    if (!this.classificationSet) {\n      return [];\n    }\n\n    const items = this.classificationSet.items;\n\n    if (!this.classificationFilter) {\n      return items;\n    }\n\n    const filteredItems = [];\n\n    if (items) {\n      for (const item of items) {\n        for (const filter of this.classificationFilter) {\n          if (filter.toLowerCase() === item.value.toLowerCase()) {\n            filteredItems.push(item);\n          }\n        }\n      }\n    }\n\n    return filteredItems;\n  }\n}\n"],"mappings":";;;;;AAAA;;AACA;;;;;;;;;;;;;;;;;;IAEqBA,qB;;;EACnB,+BAAYC,MAAZ,EAAoBC,UAApB,EAAgC;IAAA;;IAC9B,4BAAMD,MAAN,EAAcC,UAAd;IAEA,MAAKC,UAAL,GAAkB,CAAC,CAACD,UAAU,CAACE,WAA/B;IAEA,MAAKC,qBAAL,GAA6B,IAA7B;IAEA,MAAKC,4BAAL,GAAoC,IAApC;IAEA,MAAKC,oBAAL,GAA4BL,UAAU,CAACM,qBAAvC;IAT8B;EAU/B;;;;SAEDC,I,GAAA,cAAKC,UAAL,EAAiBC,QAAjB,EAA2B;IAAA;;IACzBD,UAAU,CAACE,oBAAX,CAAgC,KAAKL,oBAArC,EAA2D,UAACM,GAAD,EAAMC,iBAAN,EAA4B;MACrF;MACA;MACA;MACA,IAAID,GAAJ,EAAS;QACP,OAAOF,QAAQ,CAACE,GAAD,CAAf;MACD;;MAED,MAAI,CAACC,iBAAL,GAAyBA,iBAAzB;MAEA,OAAOH,QAAQ,EAAf;IACD,CAXD;EAYD,C;;SAsCDI,c,GAAA,0BAAiB;IACf,mBAAMA,cAAN;;IAEA,KAAKV,qBAAL,GAA6B,IAA7B;IACA,KAAKC,4BAAL,GAAoC,IAApC;EACD,C;;;;SAzCD,eAA0B;MACxB,OAAO,KAAKA,4BAAL,GAAoC,KAAKA,4BAAzC,GAAwE,KAAKU,uBAApF;IACD;;;SAED,eAA2B;MACzB,OAAO,KAAKX,qBAAZ;IACD,C;SAED,aAAyBY,oBAAzB,EAA+C;MAC7C,KAAKZ,qBAAL,GAA6BY,oBAA7B;IACD;;;SAED,aAAgCC,8BAAhC,EAAgE;MAC9D,IAAI,CAACA,8BAAD,IAAmCA,8BAA8B,CAACC,MAA/B,GAAwC,CAA/E,EAAkF;QAChF,KAAKb,4BAAL,GAAoC,IAApC;QACA;MACD;;MAED,IAAMc,mBAAmB,GAAG,EAA5B;;MAEA,qDAAuCF,8BAAvC,wCAAuE;QAAA,IAA5DG,wBAA4D;QACrE,IAAMC,cAAc,GAAG,IAAIC,0BAAJ,CAAmB,IAAnB,EAAyBF,wBAAzB,CAAvB;QAEAD,mBAAmB,CAACI,IAApB,CAAyBF,cAAzB;MACD;;MAED,KAAKhB,4BAAL,GAAoCc,mBAApC;IACD;;;SAED,eAAqB;MACnB,OAAOK,MAAM,CAACC,MAAP,CAAcD,MAAM,CAACE,wBAAP,CAAgCC,mBAAA,CAAQC,SAAxC,EAAmD,gBAAnD,EAAqEC,GAArE,CAAyEC,IAAzE,CAA8E,IAA9E,CAAd,EAAmG;QACxGd,oBAAoB,EAAE,KAAKZ,qBAD6E;QAExG2B,2BAA2B,EAAE,KAAK1B;MAFsE,CAAnG,CAAP;IAID;;;SASD,eAA8B;MAC5B,IAAI,CAAC,KAAKQ,iBAAV,EAA6B;QAC3B,OAAO,EAAP;MACD;;MAED,IAAMmB,KAAK,GAAG,KAAKnB,iBAAL,CAAuBmB,KAArC;;MAEA,IAAI,CAAC,KAAKhB,oBAAV,EAAgC;QAC9B,OAAOgB,KAAP;MACD;;MAED,IAAMC,aAAa,GAAG,EAAtB;;MAEA,IAAID,KAAJ,EAAW;QACT,sDAAmBA,KAAnB,2CAA0B;UAAA,IAAfE,IAAe;;UACxB,sDAAqB,KAAKlB,oBAA1B,2CAAgD;YAAA,IAArCmB,MAAqC;;YAC9C,IAAIA,MAAM,CAACC,WAAP,OAAyBF,IAAI,CAACG,KAAL,CAAWD,WAAX,EAA7B,EAAuD;cACrDH,aAAa,CAACV,IAAd,CAAmBW,IAAnB;YACD;UACF;QACF;MACF;;MAED,OAAOD,aAAP;IACD;;;;EA/FgDN,mB"}