{"version":3,"file":"classification-element.js","names":["ClassificationElement","parent","attributes","allowOther","allow_other","_classificationFilter","_overrideClassificationItems","_classificationSetID","classification_set_id","load","dataSource","callback","getClassificationSet","err","classificationSet","resetOverrides","filteredClassifications","classificationFilter","overrideClassificationSetItems","length","classificationItems","classificationAttributes","classification","Classification","push","Object","assign","getOwnPropertyDescriptor","Element","prototype","get","call","overrideClassificationItems","items","filteredItems","item","filter","toLowerCase","value"],"sources":["../../src/elements/classification-element.js"],"sourcesContent":["import Element from './element';\nimport Classification from './classification';\n\nexport default class ClassificationElement extends Element {\n  constructor(parent, attributes) {\n    super(parent, attributes);\n\n    this.allowOther = !!attributes.allow_other;\n\n    this._classificationFilter = null;\n\n    this._overrideClassificationItems = null;\n\n    this._classificationSetID = attributes.classification_set_id;\n  }\n\n  load(dataSource, callback) {\n    dataSource.getClassificationSet(this._classificationSetID, (err, classificationSet) => {\n      // TODO(zhm) Some forms have orphaned classification sets (life sucks)\n      // Maybe we should add a parameter to the load() method to throw\n      // errors.\n      if (err) {\n        return callback(err);\n      }\n\n      this.classificationSet = classificationSet;\n\n      return callback();\n    });\n  }\n\n  get classificationItems() {\n    return this._overrideClassificationItems ? this._overrideClassificationItems : this.filteredClassifications;\n  }\n\n  get classificationFilter() {\n    return this._classificationFilter;\n  }\n\n  set classificationFilter(classificationFilter) {\n    this._classificationFilter = classificationFilter;\n  }\n\n  set overrideClassificationItems(overrideClassificationSetItems) {\n    if (!overrideClassificationSetItems || overrideClassificationSetItems.length < 1) {\n      this._overrideClassificationItems = null;\n      return;\n    }\n\n    const classificationItems = [];\n\n    for (const classificationAttributes of overrideClassificationSetItems) {\n      const classification = new Classification(null, classificationAttributes);\n\n      classificationItems.push(classification);\n    }\n\n    this._overrideClassificationItems = classificationItems;\n  }\n\n  get overrideValues() {\n    return Object.assign(Object.getOwnPropertyDescriptor(Element.prototype, 'overrideValues').get.call(this), {\n      classificationFilter: this._classificationFilter,\n      overrideClassificationItems: this._overrideClassificationItems\n    });\n  }\n\n  resetOverrides() {\n    super.resetOverrides();\n\n    this._classificationFilter = null;\n    this._overrideClassificationItems = null;\n  }\n\n  get filteredClassifications() {\n    if (!this.classificationSet) {\n      return [];\n    }\n\n    const items = this.classificationSet.items;\n\n    if (!this.classificationFilter) {\n      return items;\n    }\n\n    const filteredItems = [];\n\n    if (items) {\n      for (const item of items) {\n        for (const filter of this.classificationFilter) {\n          if (filter.toLowerCase() === item.value.toLowerCase()) {\n            filteredItems.push(item);\n          }\n        }\n      }\n    }\n\n    return filteredItems;\n  }\n}\n"],"mappings":"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"}