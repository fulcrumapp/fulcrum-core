{"version":3,"file":"child-elements.js","names":["ChildElements","createChildElements","elements","_elements","element","el","ElementFactory","create","push","elementsOfType","type","recurseRepeatables","result","flattenElements","_flattenElements","flat","recurse","isRepeatableElement","concat","_flattenElementsByAttribute","attr","children","Object","keys","key","_elementsJSON","_elementsByKey","_elementsByDataName","Mixin"],"sources":["../../src/elements/child-elements.js"],"sourcesContent":["import Mixin from 'mixmatch';\nimport ElementFactory from './element-factory';\n\nexport default class ChildElements extends Mixin {\n  get elements() {\n    if (!this._elements) {\n      this.createChildElements(this._elementsJSON);\n    }\n\n    return this._elements;\n  }\n\n  createChildElements(elements) {\n    this._elements = [];\n\n    if (elements) {\n      for (const element of elements) {\n        const el = ElementFactory.create(this, element);\n\n        if (el) {\n          this._elements.push(el);\n        }\n      }\n    }\n  }\n\n  get allElements() {\n    return this._flattenElements(this.elements);\n  }\n\n  get elementsByKey() {\n    if (this._elementsByKey == null) {\n      this._elementsByKey = this._flattenElementsByAttribute(this.elements, 'key');\n    }\n\n    return this._elementsByKey;\n  }\n\n  get elementsByDataName() {\n    if (this._elementsByDataName == null) {\n      this._elementsByDataName = this._flattenElementsByAttribute(this.elements, 'dataName');\n    }\n\n    return this._elementsByDataName;\n  }\n\n  elementsOfType(type, recurseRepeatables = true) {\n    const result = [];\n\n    for (const element of this.flattenElements(recurseRepeatables)) {\n      if (element.type === type) {\n        result.push(element);\n      }\n    }\n\n    return result;\n  }\n\n  flattenElements(recurseRepeatables = true) {\n    return this._flattenElements(this.elements, recurseRepeatables);\n  }\n\n  _flattenElements(elements, recurseRepeatables = true) {\n    let flat = [];\n\n    for (const element of elements) {\n      flat.push(element);\n\n      let recurse = true;\n\n      if (!recurseRepeatables && element.isRepeatableElement) {\n        recurse = false;\n      }\n\n      if (recurse && element.elements) {\n        flat = flat.concat(this._flattenElements(element.elements, recurseRepeatables));\n      }\n    }\n\n    return flat;\n  }\n\n  _flattenElementsByAttribute(elements, attr) {\n    const flat = {};\n\n    for (const element of elements) {\n      flat[element[attr]] = element;\n\n      if (element.elements) {\n        const children = this._flattenElementsByAttribute(element.elements, attr);\n\n        for (const key of Object.keys(children)) {\n          flat[key] = children[key];\n        }\n      }\n    }\n\n    return flat;\n  }\n}\n"],"mappings":"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"}