{"version":3,"file":"child-elements.js","names":["ChildElements","createChildElements","elements","_elements","element","el","ElementFactory","create","push","elementsOfType","type","recurseRepeatables","result","flattenElements","_flattenElements","flat","recurse","isRepeatableElement","concat","_flattenElementsByAttribute","attr","children","Object","keys","key","_elementsJSON","_elementsByKey","_elementsByDataName","Mixin"],"sources":["../../src/elements/child-elements.js"],"sourcesContent":["import Mixin from 'mixmatch';\nimport ElementFactory from './element-factory';\n\nexport default class ChildElements extends Mixin {\n  get elements() {\n    if (!this._elements) {\n      this.createChildElements(this._elementsJSON);\n    }\n\n    return this._elements;\n  }\n\n  createChildElements(elements) {\n    this._elements = [];\n\n    if (elements) {\n      for (const element of elements) {\n        const el = ElementFactory.create(this, element);\n\n        if (el) {\n          this._elements.push(el);\n        }\n      }\n    }\n  }\n\n  get allElements() {\n    return this._flattenElements(this.elements);\n  }\n\n  get elementsByKey() {\n    if (this._elementsByKey == null) {\n      this._elementsByKey = this._flattenElementsByAttribute(this.elements, 'key');\n    }\n\n    return this._elementsByKey;\n  }\n\n  get elementsByDataName() {\n    if (this._elementsByDataName == null) {\n      this._elementsByDataName = this._flattenElementsByAttribute(this.elements, 'dataName');\n    }\n\n    return this._elementsByDataName;\n  }\n\n  elementsOfType(type, recurseRepeatables = true) {\n    const result = [];\n\n    for (const element of this.flattenElements(recurseRepeatables)) {\n      if (element.type === type) {\n        result.push(element);\n      }\n    }\n\n    return result;\n  }\n\n  flattenElements(recurseRepeatables = true) {\n    return this._flattenElements(this.elements, recurseRepeatables);\n  }\n\n  _flattenElements(elements, recurseRepeatables = true) {\n    let flat = [];\n\n    for (const element of elements) {\n      flat.push(element);\n\n      let recurse = true;\n\n      if (!recurseRepeatables && element.isRepeatableElement) {\n        recurse = false;\n      }\n\n      if (recurse && element.elements) {\n        flat = flat.concat(this._flattenElements(element.elements, recurseRepeatables));\n      }\n    }\n\n    return flat;\n  }\n\n  _flattenElementsByAttribute(elements, attr) {\n    const flat = {};\n\n    for (const element of elements) {\n      flat[element[attr]] = element;\n\n      if (element.elements) {\n        const children = this._flattenElementsByAttribute(element.elements, attr);\n\n        for (const key of Object.keys(children)) {\n          flat[key] = children[key];\n        }\n      }\n    }\n\n    return flat;\n  }\n}\n"],"mappings":"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"}