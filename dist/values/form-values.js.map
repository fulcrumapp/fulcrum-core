{"version":3,"file":"form-values.js","names":["SearchValueSeparator","FormValues","container","attributes","_values","loadValues","elements","get","key","set","value","FormValue","Error","find","dataName","element","elementsByDataName","loadValue","isSectionElement","rawValue","formValue","FormValueFactory","create","toJSON","json","Object","keys","jsonValue","toSimpleJSON","copy","all","createValue","merge","formValues","createValueFromString","string","isTextElement","isChoiceElement","choice","choiceByValue","choice_values","isYesNoElement","isBarcodeElement","isClassificationElement","isDateElement","isTimeElement","isHyperlinkElement","createValueFromOtherValue","otherValue","destinationIsTextual","TextualElement","otherIsTextual","stringValue","textValue","isCalculatedElement","isNumeric","displayValue","TextUtils","isPresent","isEmpty","isAddressElement","clearInvisibleValues","valuesForConditions","record","elementsToRemove","cache","skipElement","isHidden","hasHiddenParent","isPreserved","shouldBeVisible","Condition","shouldElementBeVisible","push","blankValue","result","searchValues","searchValue","searchableValue","trim","join","values","MediaValue","apply","items","SignatureValue","RepeatableValue","item","mediaValues","repeatableItems","RecordLinkValue","recordLinkItems"],"sources":["../../src/values/form-values.js"],"sourcesContent":["import FormValueFactory from './form-value-factory';\nimport FormValue from './form-value';\nimport TextualElement from '../elements/textual-element';\nimport TextUtils from '../utils/text-utils';\nimport Condition from '../elements/condition';\nimport MediaValue from './media-value';\nimport SignatureValue from './signature-value';\nimport RepeatableValue from './repeatable-value';\nimport RecordLinkValue from './record-link-value';\n\nconst SearchValueSeparator = ' ';\n\nexport default class FormValues {\n  constructor(container, attributes) {\n    this._values = {};\n    this.container = container;\n    this.loadValues(container.elements, attributes || {});\n  }\n\n  get all() {\n    const result = [];\n\n    for (const key of Object.keys(this._values)) {\n      result.push(this._values[key]);\n    }\n\n    return result;\n  }\n\n  get(key) {\n    return this._values[key];\n  }\n\n  set(key, value) {\n    if (value && !(value instanceof FormValue)) {\n      throw new Error('Invalid value ' + value);\n    }\n\n    if (value != null) {\n      this._values[key] = value;\n    } else {\n      delete this._values[key];\n    }\n  }\n\n  find(dataName) {\n    const element = this.container.elementsByDataName[dataName];\n\n    if (element) {\n      return this.get(element.key);\n    }\n\n    return null;\n  }\n\n  loadValues(elements, attributes) {\n    for (const element of elements) {\n      this.loadValue(element, attributes);\n    }\n  }\n\n  loadValue(element, attributes) {\n    if (element.isSectionElement) {\n      this.loadValues(element.elements, attributes);\n    } else {\n      const rawValue = attributes[element.key];\n\n      if (rawValue != null) {\n        const formValue = FormValueFactory.create(element, rawValue);\n\n        this.set(element.key, formValue);\n      }\n    }\n  }\n\n  toJSON() {\n    const json = {};\n\n    for (const key of Object.keys(this._values)) {\n      const formValue = this._values[key];\n\n      if (formValue) {\n        const jsonValue = formValue.toJSON();\n\n        if (jsonValue) {\n          json[key] = jsonValue;\n        }\n      }\n    }\n\n    return json;\n  }\n\n  toSimpleJSON() {\n    const json = {};\n\n    for (const key of Object.keys(this._values)) {\n      const formValue = this._values[key];\n\n      if (formValue) {\n        const jsonValue = formValue.toSimpleJSON();\n\n        if (jsonValue) {\n          json[formValue.element.dataName] = jsonValue;\n        }\n      }\n    }\n\n    return json;\n  }\n\n  copy() {\n    const copy = new FormValues(this.container);\n\n    for (const value of this.all) {\n      // deep copy all of the field values\n      copy.set(\n        value.element.key,\n        copy.createValue(value.element, value != null ? value.toJSON() : null)\n      );\n    }\n\n    return copy;\n  }\n\n  merge(formValues) {\n    if (!(formValues instanceof FormValues)) {\n      throw new Error('Invalid values');\n    }\n\n    for (const key of Object.keys(formValues._values)) {\n      const formValue = formValues._values[key];\n\n      this.set(key, formValue);\n    }\n  }\n\n  createValue(element, rawValue) {\n    if (element == null) {\n      throw new Error('element cannot be null');\n    }\n\n    return FormValueFactory.create(element, rawValue != null ? rawValue : null);\n  }\n\n  createValueFromString(element, string) {\n    if (element.isTextElement) {\n      return this.createValue(element, string);\n    } else if (element.isChoiceElement) {\n      const choice = element.choiceByValue(string);\n\n      if (choice) {\n        return this.createValue(element, {choice_values: [ choice.value ]});\n      }\n    } else if (element.isYesNoElement) {\n      return this.createValue(element, string);\n    } else if (element.isBarcodeElement) {\n      return this.createValue(element, string);\n    } else if (element.isClassificationElement) {\n      return this.createValue(element, {choice_values: [ string ]});\n    } else if (element.isDateElement) {\n      return this.createValue(element, string);\n    } else if (element.isTimeElement) {\n      return this.createValue(element, string);\n    } else if (element.isHyperlinkElement) {\n      return this.createValue(element, string);\n    }\n\n    return null;\n  }\n\n  createValueFromOtherValue(element, otherValue) {\n    if (otherValue == null) {\n      return this.createValue(element, null);\n    }\n\n    const destinationIsTextual = element instanceof TextualElement;\n    const otherIsTextual = otherValue.element instanceof TextualElement;\n\n    if (destinationIsTextual && otherIsTextual) {\n      // converting text -> text\n      // if the other field is a calculated field and it's being copied to a regular text field,\n      // use the display value instead of the raw value so it can use the display formatting logic\n\n      let stringValue = otherValue.textValue;\n\n      if (otherValue.element.isCalculatedElement && element.isTextElement) {\n        if (!element.isNumeric) {\n          stringValue = otherValue.displayValue;\n        }\n      }\n\n      return this.createValue(element, stringValue);\n    } else if (destinationIsTextual && !otherIsTextual) {\n      // converting choice -> text\n      if (otherValue.element.isChoiceElement || otherValue.element.isClassificationElement) {\n        const displayValue = otherValue.displayValue;\n\n        if (TextUtils.isPresent(displayValue)) {\n          return this.createValue(element, displayValue);\n        }\n      }\n    } else if (!destinationIsTextual && otherIsTextual) {\n      // converting text -> choice\n      if (element.isChoiceElement) {\n        if (!otherValue.isEmpty) {\n          return this.createValueFromString(element, otherValue.textValue);\n        }\n      }\n    } else if (!destinationIsTextual && !otherIsTextual) {\n      // choice -> choice\n      if ((element.isChoiceElement && otherValue.element.isChoiceElement) ||\n          (element.isClassificationElement && otherValue.element.isClassificationElement)) {\n        return this.createValue(element, otherValue.toJSON());\n      } else if (element.isAddressElement && otherValue.element.isAddressElement) {\n        // address -> address\n        return this.createValue(element, otherValue.toJSON());\n      }\n    }\n\n    return null;\n  }\n\n  get elements() {\n    return this.container.elements;\n  }\n\n  get searchableValue() {\n    const searchValues = [];\n\n    for (const key of Object.keys(this._values)) {\n      const formValue = this._values[key];\n\n      if (formValue) {\n        const searchValue = formValue.searchableValue;\n\n        if (searchValue != null) {\n          searchValues.push(searchValue.trim());\n        }\n      }\n    }\n\n    return searchValues.join(SearchValueSeparator).trim();\n  }\n\n  clearInvisibleValues(valuesForConditions, record) {\n    const elementsToRemove = [];\n\n    const cache = {};\n\n    for (const formValue of this.all) {\n      const element = formValue.element;\n\n      // don't clear out fields that are:\n      //   * are explicitly marked hidden\n      //   * or have any parents explicitly marked as hidden\n      //   * or have any parents explicitly marked to preserve values\n      const skipElement = element.isHidden || element.hasHiddenParent || element.isPreserved;\n\n      if (!skipElement) {\n        const shouldBeVisible = Condition.shouldElementBeVisible(element,\n                                                                 record,\n                                                                 valuesForConditions,\n                                                                 cache);\n\n        if (!shouldBeVisible) {\n          elementsToRemove.push(element);\n        }\n      }\n    }\n\n    for (const element of elementsToRemove) {\n      const blankValue = this.createValue(element, null);\n\n      this.set(element.key, blankValue);\n    }\n  }\n\n  get mediaValues() {\n    const values = [];\n\n    for (const formValue of this.all) {\n      if (formValue instanceof MediaValue) {\n        values.push.apply(values, formValue.items);\n      } else if (formValue instanceof SignatureValue) {\n        values.push(formValue);\n      } else if (formValue instanceof RepeatableValue) {\n        for (const item of formValue.items) {\n          values.push.apply(values, item.formValues.mediaValues);\n        }\n      }\n    }\n\n    return values;\n  }\n\n  get repeatableItems() {\n    const items = [];\n\n    for (const formValue of this.all) {\n      if (formValue instanceof RepeatableValue) {\n        items.push.apply(items, formValue.items);\n\n        for (const item of formValue.items) {\n          items.push.apply(items, item.formValues.repeatableItems);\n        }\n      }\n    }\n\n    return items;\n  }\n\n  get recordLinkItems() {\n    const items = [];\n\n    for (const formValue of this.all) {\n      if (formValue instanceof RecordLinkValue) {\n        items.push.apply(items, formValue.items);\n      } else if (formValue instanceof RepeatableValue) {\n        for (const item of formValue.items) {\n          items.push.apply(items, item.formValues.recordLinkItems);\n        }\n      }\n    }\n\n    return items;\n  }\n}\n"],"mappings":"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"}