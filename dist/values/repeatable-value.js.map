{"version":3,"file":"repeatable-value.js","names":["SearchSeparator","RepeatableValue","element","items","_items","item","push","RepeatableItemValue","length","format","options","isEmpty","useDisplayValue","displayValue","toJSON","toSimpleJSON","simple","isEqual","value","contains","startsWith","isLessThan","isGreaterThan","mapItems","callback","slice","map","forEachItem","itemIndex","id","index","insertItem","removeItem","splice","createNewItem","attributes","uuid","v4","form_values","values","searchValue","searchableValue","TextUtils","isPresent","join","FormValue"],"sources":["../../src/values/repeatable-value.js"],"sourcesContent":["import FormValue from './form-value';\nimport RepeatableItemValue from './repeatable-item-value';\nimport TextUtils from '../utils/text-utils';\nimport uuid from 'uuid';\n\nconst SearchSeparator = ' ';\n\nexport default class RepeatableValue extends FormValue {\n  constructor(element, items) {\n    super(element, items);\n\n    this._items = [];\n\n    if (items != null) {\n      for (const item of items) {\n        this._items.push(new RepeatableItemValue(this.element, item, this._items.length));\n      }\n    }\n  }\n\n  get isEmpty() {\n    return this._items.length === 0;\n  }\n\n  get displayValue() {\n    if (this.length === 1) {\n      return '1 Item';\n    }\n\n    return this.length + ' Items';\n  }\n\n  get searchableValue() {\n    if (this.isEmpty) {\n      return null;\n    }\n\n    const values = [];\n\n    for (const item of this._items) {\n      const searchValue = item.searchableValue;\n\n      if (TextUtils.isPresent(searchValue)) {\n        values.push(searchValue);\n      }\n    }\n\n    return values.join(SearchSeparator);\n  }\n\n  format(options) {\n    if (this.isEmpty) {\n      return null;\n    }\n\n    return options.useDisplayValue ? this.displayValue : this.length;\n  }\n\n  get length() {\n    return this._items.length;\n  }\n\n  toJSON() {\n    if (this.isEmpty) {\n      return null;\n    }\n\n    const items = [];\n\n    for (const item of this._items) {\n      items.push(item.toJSON());\n    }\n\n    return items;\n  }\n\n  toSimpleJSON() {\n    if (this.isEmpty) {\n      return null;\n    }\n\n    const items = [];\n\n    for (const item of this._items) {\n      items.push(item.toJSON({simple: true}));\n    }\n\n    return items;\n  }\n\n  get columnValue() {\n    return null;\n  }\n\n  get multipleValues() {\n    return null;\n  }\n\n  isEqual(value) {\n    return false;\n  }\n\n  contains(value) {\n    return false;\n  }\n\n  startsWith(value) {\n    return false;\n  }\n\n  isLessThan(value) {\n    return false;\n  }\n\n  isGreaterThan(value) {\n    return false;\n  }\n\n  mapItems(callback) {\n    return this._items.slice().map(callback);\n  }\n\n  // return a copy until it's determined that a mutable API is necessary\n  get items() {\n    return this._items.slice();\n  }\n\n  forEachItem(callback) {\n    this.mapItems(callback);\n  }\n\n  itemIndex(id) {\n    for (let index = 0; index < this._items.length; ++index) {\n      if (id === this._items[index].id) {\n        return index;\n      }\n    }\n\n    return -1;\n  }\n\n  insertItem(item) {\n    const index = this.itemIndex(item.id);\n\n    if (index > -1) {\n      this._items[index] = item;\n    } else {\n      this._items.push(item);\n    }\n  }\n\n  removeItem(id) {\n    const index = this.itemIndex(id);\n\n    if (index > -1) {\n      const item = this._items[index];\n\n      this._items.splice(index, 1);\n\n      return item;\n    }\n\n    return null;\n  }\n\n  createNewItem() {\n    const attributes = {\n      id: uuid.v4(),\n      form_values: {}\n    };\n\n    return new RepeatableItemValue(this.element, attributes, this._items.length);\n  }\n}\n"],"mappings":"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"}