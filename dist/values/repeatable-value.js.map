{"version":3,"file":"repeatable-value.js","names":["SearchSeparator","RepeatableValue","element","items","_items","item","push","RepeatableItemValue","length","format","options","isEmpty","useDisplayValue","displayValue","toJSON","toSimpleJSON","simple","isEqual","value","contains","startsWith","isLessThan","isGreaterThan","mapItems","callback","slice","map","forEachItem","itemIndex","id","index","insertItem","removeItem","splice","createNewItem","attributes","uuid","v4","form_values","values","searchValue","searchableValue","TextUtils","isPresent","join","FormValue"],"sources":["../../src/values/repeatable-value.js"],"sourcesContent":["import FormValue from './form-value';\nimport RepeatableItemValue from './repeatable-item-value';\nimport TextUtils from '../utils/text-utils';\nimport uuid from 'uuid';\n\nconst SearchSeparator = ' ';\n\nexport default class RepeatableValue extends FormValue {\n  constructor(element, items) {\n    super(element, items);\n\n    this._items = [];\n\n    if (items != null) {\n      for (const item of items) {\n        this._items.push(new RepeatableItemValue(this.element, item, this._items.length));\n      }\n    }\n  }\n\n  get isEmpty() {\n    return this._items.length === 0;\n  }\n\n  get displayValue() {\n    if (this.length === 1) {\n      return '1 Item';\n    }\n\n    return this.length + ' Items';\n  }\n\n  get searchableValue() {\n    if (this.isEmpty) {\n      return null;\n    }\n\n    const values = [];\n\n    for (const item of this._items) {\n      const searchValue = item.searchableValue;\n\n      if (TextUtils.isPresent(searchValue)) {\n        values.push(searchValue);\n      }\n    }\n\n    return values.join(SearchSeparator);\n  }\n\n  format(options) {\n    if (this.isEmpty) {\n      return null;\n    }\n\n    return options.useDisplayValue ? this.displayValue : this.length;\n  }\n\n  get length() {\n    return this._items.length;\n  }\n\n  toJSON() {\n    if (this.isEmpty) {\n      return null;\n    }\n\n    const items = [];\n\n    for (const item of this._items) {\n      items.push(item.toJSON());\n    }\n\n    return items;\n  }\n\n  toSimpleJSON() {\n    if (this.isEmpty) {\n      return null;\n    }\n\n    const items = [];\n\n    for (const item of this._items) {\n      items.push(item.toJSON({simple: true}));\n    }\n\n    return items;\n  }\n\n  get columnValue() {\n    return null;\n  }\n\n  get multipleValues() {\n    return null;\n  }\n\n  isEqual(value) {\n    return false;\n  }\n\n  contains(value) {\n    return false;\n  }\n\n  startsWith(value) {\n    return false;\n  }\n\n  isLessThan(value) {\n    return false;\n  }\n\n  isGreaterThan(value) {\n    return false;\n  }\n\n  mapItems(callback) {\n    return this._items.slice().map(callback);\n  }\n\n  // return a copy until it's determined that a mutable API is necessary\n  get items() {\n    return this._items.slice();\n  }\n\n  forEachItem(callback) {\n    this.mapItems(callback);\n  }\n\n  itemIndex(id) {\n    for (let index = 0; index < this._items.length; ++index) {\n      if (id === this._items[index].id) {\n        return index;\n      }\n    }\n\n    return -1;\n  }\n\n  insertItem(item) {\n    const index = this.itemIndex(item.id);\n\n    if (index > -1) {\n      this._items[index] = item;\n    } else {\n      this._items.push(item);\n    }\n  }\n\n  removeItem(id) {\n    const index = this.itemIndex(id);\n\n    if (index > -1) {\n      const item = this._items[index];\n\n      this._items.splice(index, 1);\n\n      return item;\n    }\n\n    return null;\n  }\n\n  createNewItem() {\n    const attributes = {\n      id: uuid.v4(),\n      form_values: {}\n    };\n\n    return new RepeatableItemValue(this.element, attributes, this._items.length);\n  }\n}\n"],"mappings":"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"}