{"version":3,"sources":["../../src/values/dynamic-value.js"],"names":["DynamicValue","element","items","_items","Array","isArray","item","push","ItemClass","format","part","isEmpty","map","_elementsJSON","_metadataJSON","values","toJSON","isEqual","value","contains","startsWith","isLessThan","length","NumberUtils","parseDouble","isGreaterThan","addRecord","record","DynamicItemValue","record_id","id","_record","insertItem","itemIndex","index","removeItem","splice","elements","key","MultipleValueItem","slice","FormValue"],"mappings":"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","sourcesContent":["import FormValue from './form-value';\nimport DynamicItemValue from './dynamic-item-value';\nimport MultipleValueItem from './multiple-value-item';\nimport NumberUtils from '../utils/number-utils';\n\nexport default class DynamicValue extends FormValue {\n  constructor(element, items) {\n    super(element, items);\n\n    this._items = [];\n\n    if (Array.isArray(items)) {\n      for (const item of items) {\n        this._items.push(new this.ItemClass(this, item));\n      }\n    }\n  }\n\n  get ItemClass() {\n    return DynamicItemValue;\n  }\n\n  get isEmpty() {\n    return this._items.length === 0;\n  }\n\n  get searchableValue() {\n    return null;\n  }\n\n  get length() {\n    return this._items.length;\n  }\n\n  format({part = null}) {\n    if (this.isEmpty) {\n      return null;\n    }\n\n    if (part === 'elements') {\n      return this.items.map(item => item._elementsJSON);\n    } else if (part === 'metadata') {\n      return this.items.map(item => item._metadataJSON);\n    }\n\n    return this.items.map(item => item.values);\n  }\n\n  get columnValue() {\n    if (this.isEmpty) {\n      return null;\n    }\n\n    const values = [];\n    const elements = [];\n\n    for (const item of this._items) {\n      values.push(item.values);\n      elements.push(item.elements);\n    }\n\n    const value = {};\n\n    value['f' + this.element.key + '_elements'] = elements;\n    value['f' + this.element.key] = values;\n\n    return value;\n  }\n\n  toJSON() {\n    if (this.isEmpty) {\n      return null;\n    }\n\n    const items = [];\n\n    for (const item of this._items) {\n      items.push(item.toJSON());\n    }\n\n    return items;\n  }\n\n  get multipleValues() {\n    const items = [];\n\n    for (const item of this._items) {\n      items.push(new MultipleValueItem(this.element, item.values));\n    }\n\n    return items;\n  }\n\n  isEqual(value) {\n    return false;\n  }\n\n  contains(value) {\n    return false;\n  }\n\n  startsWith(value) {\n    return false;\n  }\n\n  isLessThan(value) {\n    return this.length < NumberUtils.parseDouble(value);\n  }\n\n  isGreaterThan(value) {\n    return this.length > NumberUtils.parseDouble(value);\n  }\n\n  get items() {\n    return this._items.slice();\n  }\n\n  addRecord(record) {\n    const item = new DynamicItemValue(this, {record_id: record.id});\n\n    item._record = record;\n\n    this.insertItem(item);\n  }\n\n  itemIndex(id) {\n    for (let index = 0; index < this._items.length; ++index) {\n      if (id === this._items[index].id) {\n        return index;\n      }\n    }\n\n    return -1;\n  }\n\n  insertItem(item) {\n    const index = this.itemIndex(item.id);\n\n    if (index > -1) {\n      this._items[index] = item;\n    } else {\n      this._items.push(item);\n    }\n  }\n\n  removeItem(id) {\n    const index = this.itemIndex(id);\n\n    if (index > -1) {\n      const item = this._items[index];\n\n      this._items.splice(index, 1);\n\n      return item;\n    }\n\n    return null;\n  }\n}\n"],"file":"dynamic-value.js"}