{"version":3,"file":"choice-value.js","names":["ChoiceDisplaySeparator","ChoiceSearchSeparator","ChoiceValue","element","attributes","_choiceValues","_otherValues","choice_values","choice","TextUtils","isPresent","push","other_values","format","useDisplayValue","isEmpty","values","labelStrings","sort","valueStrings","multiple","toJSON","choiceValues","otherValues","rawValue","otherValue","toSimpleJSON","labels","strings","isEqual","value","includes","selectedValues","contains","startsWith","length","choiceByValue","label","join","allValues","slice","hasOtherValue","FormValue"],"sources":["../../src/values/choice-value.js"],"sourcesContent":["import FormValue from './form-value';\nimport TextUtils from '../utils/text-utils';\nimport includes from 'lodash.includes';\n\nconst ChoiceDisplaySeparator = ', ';\nconst ChoiceSearchSeparator = ' ';\n\nexport default class ChoiceValue extends FormValue {\n  constructor(element, attributes) {\n    super(element, attributes);\n\n    this._choiceValues = [];\n    this._otherValues = [];\n\n    if (attributes) {\n      if (attributes.choice_values) {\n        for (const choice of attributes.choice_values) {\n          if (TextUtils.isPresent(choice)) {\n            this._choiceValues.push(choice);\n          }\n        }\n      }\n\n      if (attributes.other_values) {\n        for (const choice of attributes.other_values) {\n          if (TextUtils.isPresent(choice)) {\n            this._otherValues.push(choice);\n          }\n        }\n      }\n    }\n  }\n\n  get isEmpty() {\n    if (this._choiceValues.length) {\n      return false;\n    }\n    if (this._otherValues.length) {\n      return false;\n    }\n    return true;\n  }\n\n  format({useDisplayValue = false}) {\n    if (this.isEmpty) {\n      return null;\n    }\n\n    const values = useDisplayValue ? this.labelStrings.sort() : this.valueStrings.sort();\n\n    if (!this.element.multiple) {\n      return values[0];\n    }\n\n    return values;\n  }\n\n  get labelStrings() {\n    const labels = [];\n\n    for (const rawValue of this._choiceValues) {\n      const choice = this.element.choiceByValue(rawValue);\n\n      const label = (choice != null ? choice.label : rawValue);\n\n      if (TextUtils.isPresent(label)) {\n        labels.push(label);\n      }\n    }\n\n    for (const otherValue of this._otherValues) {\n      labels.push(otherValue);\n    }\n\n    return labels;\n  }\n\n  get valueStrings() {\n    const values = [];\n\n    for (const rawValue of this._choiceValues) {\n      values.push(rawValue);\n    }\n\n    for (const otherValue of this._otherValues) {\n      values.push(otherValue);\n    }\n\n    return values;\n  }\n\n  get displayValue() {\n    return this.labelStrings.join(ChoiceDisplaySeparator);\n  }\n\n  get searchableValue() {\n    const values = [];\n\n    for (const rawValue of this._choiceValues) {\n      const choice = this.element.choiceByValue(rawValue);\n\n      if (choice != null) {\n        values.push(choice.label);\n\n        if (choice.label !== choice.value) {\n          values.push(choice.value);\n        }\n      } else {\n        values.push(rawValue);\n      }\n    }\n\n    for (const otherValue of this._otherValues) {\n      values.push(otherValue);\n    }\n\n    return values.join(ChoiceSearchSeparator);\n  }\n\n  get length() {\n    return this._choiceValues.length + this._otherValues.length;\n  }\n\n  toJSON() {\n    if (this.isEmpty) {\n      return null;\n    }\n\n    const choiceValues = [];\n    const otherValues = [];\n\n    for (const rawValue of this._choiceValues) {\n      choiceValues.push(rawValue);\n    }\n\n    for (const otherValue of this._otherValues) {\n      otherValues.push(otherValue);\n    }\n\n    return {\n      choice_values: choiceValues,\n      other_values: otherValues\n    };\n  }\n\n  toSimpleJSON({labels} = {}) {\n    if (this.isEmpty) {\n      return null;\n    }\n\n    const strings = labels ? this.labelStrings : this.valueStrings;\n\n    return this.element.multiple ? strings : strings[0];\n  }\n\n  get columnValue() {\n    const allValues = this.valueStrings.sort();\n\n    if (allValues.length === 0) {\n      return null;\n    }\n\n    if (!this.element.multiple) {\n      return allValues[0];\n    }\n\n    return allValues;\n  }\n\n  get multipleValues() {\n    return null;\n  }\n\n  get hasOtherValue() {\n    return this._otherValues.length !== 0;\n  }\n\n  get selectedValues() {\n    return this._choiceValues.slice();\n  }\n\n  set selectedValues(values) {\n    this._choiceValues = (values || []).slice();\n  }\n\n  get otherValues() {\n    return this._otherValues.slice();\n  }\n\n  set otherValues(values) {\n    this._otherValues = (values || []).slice();\n  }\n\n  get otherValue() {\n    if (!this.hasOtherValue) {\n      return null;\n    }\n\n    return this._otherValues[0];\n  }\n\n  isEqual(value) {\n    if (includes(this.selectedValues, value)) {\n      return true;\n    }\n\n    return this.otherValue === value;\n  }\n\n  contains(value) {\n    return this.isEqual(value);\n  }\n\n  startsWith(value) {\n    return this.contains(value);\n  }\n\n  // isLessThan(value) {\n  //   notImplemented();\n  // }\n\n  // isGreaterThan(value) {\n  //   notImplemented();\n  // }\n}\n"],"mappings":"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"}