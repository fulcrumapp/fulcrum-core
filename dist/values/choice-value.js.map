{"version":3,"file":"choice-value.js","names":["ChoiceDisplaySeparator","ChoiceSearchSeparator","ChoiceValue","element","attributes","_choiceValues","_otherValues","choice_values","choice","TextUtils","isPresent","push","other_values","format","useDisplayValue","isEmpty","values","labelStrings","sort","valueStrings","multiple","toJSON","choiceValues","otherValues","rawValue","otherValue","toSimpleJSON","labels","strings","isEqual","value","includes","selectedValues","contains","startsWith","length","choiceByValue","label","join","allValues","slice","hasOtherValue","FormValue"],"sources":["../../src/values/choice-value.js"],"sourcesContent":["import FormValue from './form-value';\nimport TextUtils from '../utils/text-utils';\nimport includes from 'lodash.includes';\n\nconst ChoiceDisplaySeparator = ', ';\nconst ChoiceSearchSeparator = ' ';\n\nexport default class ChoiceValue extends FormValue {\n  constructor(element, attributes) {\n    super(element, attributes);\n\n    this._choiceValues = [];\n    this._otherValues = [];\n\n    if (attributes) {\n      if (attributes.choice_values) {\n        for (const choice of attributes.choice_values) {\n          if (TextUtils.isPresent(choice)) {\n            this._choiceValues.push(choice);\n          }\n        }\n      }\n\n      if (attributes.other_values) {\n        for (const choice of attributes.other_values) {\n          if (TextUtils.isPresent(choice)) {\n            this._otherValues.push(choice);\n          }\n        }\n      }\n    }\n  }\n\n  get isEmpty() {\n    if (this._choiceValues.length) {\n      return false;\n    }\n    if (this._otherValues.length) {\n      return false;\n    }\n    return true;\n  }\n\n  format({useDisplayValue = false}) {\n    if (this.isEmpty) {\n      return null;\n    }\n\n    const values = useDisplayValue ? this.labelStrings.sort() : this.valueStrings.sort();\n\n    if (!this.element.multiple) {\n      return values[0];\n    }\n\n    return values;\n  }\n\n  get labelStrings() {\n    const labels = [];\n\n    for (const rawValue of this._choiceValues) {\n      const choice = this.element.choiceByValue(rawValue);\n\n      const label = (choice != null ? choice.label : rawValue);\n\n      if (TextUtils.isPresent(label)) {\n        labels.push(label);\n      }\n    }\n\n    for (const otherValue of this._otherValues) {\n      labels.push(otherValue);\n    }\n\n    return labels;\n  }\n\n  get valueStrings() {\n    const values = [];\n\n    for (const rawValue of this._choiceValues) {\n      values.push(rawValue);\n    }\n\n    for (const otherValue of this._otherValues) {\n      values.push(otherValue);\n    }\n\n    return values;\n  }\n\n  get displayValue() {\n    return this.labelStrings.join(ChoiceDisplaySeparator);\n  }\n\n  get searchableValue() {\n    const values = [];\n\n    for (const rawValue of this._choiceValues) {\n      const choice = this.element.choiceByValue(rawValue);\n\n      if (choice != null) {\n        values.push(choice.label);\n\n        if (choice.label !== choice.value) {\n          values.push(choice.value);\n        }\n      } else {\n        values.push(rawValue);\n      }\n    }\n\n    for (const otherValue of this._otherValues) {\n      values.push(otherValue);\n    }\n\n    return values.join(ChoiceSearchSeparator);\n  }\n\n  get length() {\n    return this._choiceValues.length + this._otherValues.length;\n  }\n\n  toJSON() {\n    if (this.isEmpty) {\n      return null;\n    }\n\n    const choiceValues = [];\n    const otherValues = [];\n\n    for (const rawValue of this._choiceValues) {\n      choiceValues.push(rawValue);\n    }\n\n    for (const otherValue of this._otherValues) {\n      otherValues.push(otherValue);\n    }\n\n    return {\n      choice_values: choiceValues,\n      other_values: otherValues\n    };\n  }\n\n  toSimpleJSON({labels} = {}) {\n    if (this.isEmpty) {\n      return null;\n    }\n\n    const strings = labels ? this.labelStrings : this.valueStrings;\n\n    return this.element.multiple ? strings : strings[0];\n  }\n\n  get columnValue() {\n    const allValues = this.valueStrings.sort();\n\n    if (allValues.length === 0) {\n      return null;\n    }\n\n    if (!this.element.multiple) {\n      return allValues[0];\n    }\n\n    return allValues;\n  }\n\n  get multipleValues() {\n    return null;\n  }\n\n  get hasOtherValue() {\n    return this._otherValues.length !== 0;\n  }\n\n  get selectedValues() {\n    return this._choiceValues.slice();\n  }\n\n  set selectedValues(values) {\n    this._choiceValues = (values || []).slice();\n  }\n\n  get otherValues() {\n    return this._otherValues.slice();\n  }\n\n  set otherValues(values) {\n    this._otherValues = (values || []).slice();\n  }\n\n  get otherValue() {\n    if (!this.hasOtherValue) {\n      return null;\n    }\n\n    return this._otherValues[0];\n  }\n\n  isEqual(value) {\n    if (includes(this.selectedValues, value)) {\n      return true;\n    }\n\n    return this.otherValue === value;\n  }\n\n  contains(value) {\n    return this.isEqual(value);\n  }\n\n  startsWith(value) {\n    return this.contains(value);\n  }\n\n  // isLessThan(value) {\n  //   notImplemented();\n  // }\n\n  // isGreaterThan(value) {\n  //   notImplemented();\n  // }\n}\n"],"mappings":"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"}