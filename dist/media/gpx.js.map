{"version":3,"file":"gpx.js","names":["GPX","render","tracks","gpx","push","gpxStart","gpxTracks","gpxEnd","join","trim","timestamp","t","Date","toISOString","map","track","segments","length","gpxTrackStart","gpxTrackSegments","gpxTrackEnd","filter","o","segment","gpxTrackSegmentStart","gpxTrackPoints","gpxTrackSegmentEnd","locations","point","gpxTrackPoint","latitude","longitude","altitude","time","id"],"sources":["../../src/media/gpx.js"],"sourcesContent":["export default class GPX {\n  static render(tracks) {\n    return new GPX().render(tracks);\n  }\n\n  render(tracks) {\n    const gpx = [];\n\n    gpx.push(this.gpxStart());\n    gpx.push(this.gpxTracks(tracks));\n    gpx.push(this.gpxEnd());\n\n    return gpx.join('\\n').trim();\n  }\n\n  timestamp(t) {\n    if (t == null) {\n      return null;\n    }\n\n    return new Date(+t).toISOString();\n  }\n\n  gpxStart() {\n    return `\n<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\" ?>\n<gpx xmlns=\"http://www.topografix.com/GPX/1/1\"\n     xmlns:gpxx=\"http://www.garmin.com/xmlschemas/GpxExtensions/v3\"\n     xmlns:gpxtpx=\"http://www.garmin.com/xmlschemas/TrackPointExtension/v1\"\n     xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n     xsi:schemaLocation=\"http://www.topografix.com/GPX/1/1 http://www.topografix.com/GPX/1/1/gpx.xsd http://www.garmin.com/xmlschemas/GpxExtensions/v3 http://www.garmin.com/xmlschemas/GpxExtensionsv3.xsd http://www.garmin.com/xmlschemas/TrackPointExtension/v1 http://www.garmin.com/xmlschemas/TrackPointExtensionv1.xsd\"\n     creator=\"Fulcrum\"\n     version=\"1.1\">\n<metadata>\n  <link href=\"http://fulcrumapp.com\">\n    <text>Fulcrum</text>\n  </link>\n</metadata>\n`;\n  }\n\n  gpxTracks(tracks) {\n    return tracks.map((track) => {\n      if (track.segments.length) {\n        const gpx = [];\n\n        gpx.push(this.gpxTrackStart(track));\n        gpx.push(this.gpxTrackSegments(track));\n        gpx.push(this.gpxTrackEnd(track));\n\n        return gpx.join('\\n');\n      }\n\n      return null;\n    }).filter(o => o).join('\\n');\n  }\n\n  gpxTrackSegments(track) {\n    return track.segments.map((segment) => {\n      const gpx = [];\n\n      gpx.push(this.gpxTrackSegmentStart(track));\n      gpx.push(this.gpxTrackPoints(segment));\n      gpx.push(this.gpxTrackSegmentEnd());\n\n      return gpx.join('\\n');\n    });\n  }\n\n  gpxTrackPoints(track) {\n    return track.locations.map((point) => {\n      return this.gpxTrackPoint(point);\n    }).join('\\n');\n  }\n\n  gpxTrackPoint(point) {\n    return `\n<trkpt lat=\"${point.latitude}\" lon=\"${point.longitude}\">\n<ele>${point.altitude}</ele>\n<time>${this.timestamp(point.time)}</time>\n</trkpt>\n`;\n  }\n\n  gpxTrackStart(track) {\n    return `\n<trk>\n  <name>${track.id}</name>\n`;\n  }\n\n  gpxTrackSegmentStart() {\n    return '<trkseg>';\n  }\n\n  gpxTrackSegmentEnd() {\n    return '</trkseg>';\n  }\n\n  gpxTrackEnd() {\n    return '</trk>';\n  }\n\n  gpxEnd() {\n    return '</gpx>';\n  }\n}\n"],"mappings":"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"}