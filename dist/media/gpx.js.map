{"version":3,"file":"gpx.js","names":["GPX","render","tracks","gpx","push","gpxStart","gpxTracks","gpxEnd","join","trim","timestamp","t","Date","toISOString","map","track","segments","length","gpxTrackStart","gpxTrackSegments","gpxTrackEnd","filter","o","segment","gpxTrackSegmentStart","gpxTrackPoints","gpxTrackSegmentEnd","locations","point","gpxTrackPoint","latitude","longitude","altitude","time","id"],"sources":["../../src/media/gpx.js"],"sourcesContent":["export default class GPX {\n  static render(tracks) {\n    return new GPX().render(tracks);\n  }\n\n  render(tracks) {\n    const gpx = [];\n\n    gpx.push(this.gpxStart());\n    gpx.push(this.gpxTracks(tracks));\n    gpx.push(this.gpxEnd());\n\n    return gpx.join('\\n').trim();\n  }\n\n  timestamp(t) {\n    if (t == null) {\n      return null;\n    }\n\n    return new Date(+t).toISOString();\n  }\n\n  gpxStart() {\n    return `\n<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\" ?>\n<gpx xmlns=\"http://www.topografix.com/GPX/1/1\"\n     xmlns:gpxx=\"http://www.garmin.com/xmlschemas/GpxExtensions/v3\"\n     xmlns:gpxtpx=\"http://www.garmin.com/xmlschemas/TrackPointExtension/v1\"\n     xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n     xsi:schemaLocation=\"http://www.topografix.com/GPX/1/1 http://www.topografix.com/GPX/1/1/gpx.xsd http://www.garmin.com/xmlschemas/GpxExtensions/v3 http://www.garmin.com/xmlschemas/GpxExtensionsv3.xsd http://www.garmin.com/xmlschemas/TrackPointExtension/v1 http://www.garmin.com/xmlschemas/TrackPointExtensionv1.xsd\"\n     creator=\"Fulcrum\"\n     version=\"1.1\">\n<metadata>\n  <link href=\"http://fulcrumapp.com\">\n    <text>Fulcrum</text>\n  </link>\n</metadata>\n`;\n  }\n\n  gpxTracks(tracks) {\n    return tracks.map((track) => {\n      if (track.segments.length) {\n        const gpx = [];\n\n        gpx.push(this.gpxTrackStart(track));\n        gpx.push(this.gpxTrackSegments(track));\n        gpx.push(this.gpxTrackEnd(track));\n\n        return gpx.join('\\n');\n      }\n\n      return null;\n    }).filter(o => o).join('\\n');\n  }\n\n  gpxTrackSegments(track) {\n    return track.segments.map((segment) => {\n      const gpx = [];\n\n      gpx.push(this.gpxTrackSegmentStart(track));\n      gpx.push(this.gpxTrackPoints(segment));\n      gpx.push(this.gpxTrackSegmentEnd());\n\n      return gpx.join('\\n');\n    });\n  }\n\n  gpxTrackPoints(track) {\n    return track.locations.map((point) => {\n      return this.gpxTrackPoint(point);\n    }).join('\\n');\n  }\n\n  gpxTrackPoint(point) {\n    return `\n<trkpt lat=\"${point.latitude}\" lon=\"${point.longitude}\">\n<ele>${point.altitude}</ele>\n<time>${this.timestamp(point.time)}</time>\n</trkpt>\n`;\n  }\n\n  gpxTrackStart(track) {\n    return `\n<trk>\n  <name>${track.id}</name>\n`;\n  }\n\n  gpxTrackSegmentStart() {\n    return '<trkseg>';\n  }\n\n  gpxTrackSegmentEnd() {\n    return '</trkseg>';\n  }\n\n  gpxTrackEnd() {\n    return '</trk>';\n  }\n\n  gpxEnd() {\n    return '</gpx>';\n  }\n}\n"],"mappings":";;;;IAAqBA,GAAG;EAAA;EAAA,IACfC,MAAM,GAAb,gBAAcC,MAAM,EAAE;IACpB,OAAO,IAAIF,GAAG,EAAE,CAACC,MAAM,CAACC,MAAM,CAAC;EACjC,CAAC;EAAA;EAAA,OAEDD,MAAM,GAAN,gBAAOC,MAAM,EAAE;IACb,IAAMC,GAAG,GAAG,EAAE;IAEdA,GAAG,CAACC,IAAI,CAAC,IAAI,CAACC,QAAQ,EAAE,CAAC;IACzBF,GAAG,CAACC,IAAI,CAAC,IAAI,CAACE,SAAS,CAACJ,MAAM,CAAC,CAAC;IAChCC,GAAG,CAACC,IAAI,CAAC,IAAI,CAACG,MAAM,EAAE,CAAC;IAEvB,OAAOJ,GAAG,CAACK,IAAI,CAAC,IAAI,CAAC,CAACC,IAAI,EAAE;EAC9B,CAAC;EAAA,OAEDC,SAAS,GAAT,mBAAUC,CAAC,EAAE;IACX,IAAIA,CAAC,IAAI,IAAI,EAAE;MACb,OAAO,IAAI;IACb;IAEA,OAAO,IAAIC,IAAI,CAAC,CAACD,CAAC,CAAC,CAACE,WAAW,EAAE;EACnC,CAAC;EAAA,OAEDR,QAAQ,GAAR,oBAAW;IACT;EAeF,CAAC;EAAA,OAEDC,SAAS,GAAT,mBAAUJ,MAAM,EAAE;IAAA;IAChB,OAAOA,MAAM,CAACY,GAAG,CAAC,UAACC,KAAK,EAAK;MAC3B,IAAIA,KAAK,CAACC,QAAQ,CAACC,MAAM,EAAE;QACzB,IAAMd,GAAG,GAAG,EAAE;QAEdA,GAAG,CAACC,IAAI,CAAC,KAAI,CAACc,aAAa,CAACH,KAAK,CAAC,CAAC;QACnCZ,GAAG,CAACC,IAAI,CAAC,KAAI,CAACe,gBAAgB,CAACJ,KAAK,CAAC,CAAC;QACtCZ,GAAG,CAACC,IAAI,CAAC,KAAI,CAACgB,WAAW,CAACL,KAAK,CAAC,CAAC;QAEjC,OAAOZ,GAAG,CAACK,IAAI,CAAC,IAAI,CAAC;MACvB;MAEA,OAAO,IAAI;IACb,CAAC,CAAC,CAACa,MAAM,CAAC,UAAAC,CAAC;MAAA,OAAIA,CAAC;IAAA,EAAC,CAACd,IAAI,CAAC,IAAI,CAAC;EAC9B,CAAC;EAAA,OAEDW,gBAAgB,GAAhB,0BAAiBJ,KAAK,EAAE;IAAA;IACtB,OAAOA,KAAK,CAACC,QAAQ,CAACF,GAAG,CAAC,UAACS,OAAO,EAAK;MACrC,IAAMpB,GAAG,GAAG,EAAE;MAEdA,GAAG,CAACC,IAAI,CAAC,MAAI,CAACoB,oBAAoB,CAACT,KAAK,CAAC,CAAC;MAC1CZ,GAAG,CAACC,IAAI,CAAC,MAAI,CAACqB,cAAc,CAACF,OAAO,CAAC,CAAC;MACtCpB,GAAG,CAACC,IAAI,CAAC,MAAI,CAACsB,kBAAkB,EAAE,CAAC;MAEnC,OAAOvB,GAAG,CAACK,IAAI,CAAC,IAAI,CAAC;IACvB,CAAC,CAAC;EACJ,CAAC;EAAA,OAEDiB,cAAc,GAAd,wBAAeV,KAAK,EAAE;IAAA;IACpB,OAAOA,KAAK,CAACY,SAAS,CAACb,GAAG,CAAC,UAACc,KAAK,EAAK;MACpC,OAAO,MAAI,CAACC,aAAa,CAACD,KAAK,CAAC;IAClC,CAAC,CAAC,CAACpB,IAAI,CAAC,IAAI,CAAC;EACf,CAAC;EAAA,OAEDqB,aAAa,GAAb,uBAAcD,KAAK,EAAE;IACnB,2BACUA,KAAK,CAACE,QAAQ,iBAAUF,KAAK,CAACG,SAAS,kBAC9CH,KAAK,CAACI,QAAQ,sBACb,IAAI,CAACtB,SAAS,CAACkB,KAAK,CAACK,IAAI,CAAC;EAGhC,CAAC;EAAA,OAEDf,aAAa,GAAb,uBAAcH,KAAK,EAAE;IACnB,6BAEMA,KAAK,CAACmB,EAAE;EAEhB,CAAC;EAAA,OAEDV,oBAAoB,GAApB,gCAAuB;IACrB,OAAO,UAAU;EACnB,CAAC;EAAA,OAEDE,kBAAkB,GAAlB,8BAAqB;IACnB,OAAO,WAAW;EACpB,CAAC;EAAA,OAEDN,WAAW,GAAX,uBAAc;IACZ,OAAO,QAAQ;EACjB,CAAC;EAAA,OAEDb,MAAM,GAAN,kBAAS;IACP,OAAO,QAAQ;EACjB,CAAC;EAAA;AAAA;AAAA"}